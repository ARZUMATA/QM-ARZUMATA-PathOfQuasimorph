# Журнал изменений

> **Примечание**: Эта версия вносит фундаментальные изменения для будущих функций. Сообщайте о любых неожиданных ошибках в поведении сохранений или Синтраформеров, прилагая логи и воспроизводимые случаи.

---

## v1.9.4 (56137a0)

### Исправлено
- **Обработка черт оружия\патронов**: Предотвращено дублирование черт, если оружие\патроны уже имеют сохранённую базовую черту. Взаимоисключающие черты теперь удаляются из доступного пула при пересборке, исключая конфликтующие черты.
- **Логика выпадения Синтраформеров**: Исправлены нестабильные шансы выпадения. Глобальный шанс выпадения Синтраформеров снижен до **2.5%** для баланса. Предметы с чертой *Неразрушимый* теперь имеют **100% шанс** выбросить *Активатор неразрушимости*, подчёркивая их редкость и ценность.

### v1.9.3 (29e12ef)

### Добавлено
  - PrimalCore теперь может понижать предмет до стандартного (ванильного) состояния

### Исправлено
  - Пересборка черт теперь сохраняет базовые черты, если проверка проходит, или добавляет дополнительные черты на основе количества базовых, если базовые черты удалены, чтобы сохранять общее количество.

### v1.9.2 (c02b853)

### Добавлено
  - Добавлены процентные индикаторы в подсказки **Рекомбинатора черт** и **Активатора неразрушимости** для прозрачности шансов успеха.
  - У Синтраформера черт теперь есть **50% шанс сохранить базовые черты** при пересборке, сохраняя полезные базовые эффекты.
  - Синтраформер редкости теперь не накладывает состояние на предмет.
  - Добавлены значения **HP и сопротивлений существ** на основе масштабирования мастерства. Полностью настраивается через CSV.
  - Новые параметры **шанса выпадения Синтраформеров** и **времени производства** теперь полностью настраиваемы через CSV.
  - Подсказки аугментаций теперь отображают **сравнение характеристик с оригинальным оружием**, если нет стандартного аналога аугментации.
  - Добавлена поддержка `ConsoleCommand` `poqcleanup` для очистки сохранения от данных POQ (аналогично Режиму Очистки).

### Изменения
  - Небольшая перебалансировка весов черт оружия для улучшения распределения и уменьшения слишком сильных или плохих комбинаций.

## 1.9.1 (d42c08f)

### Изменено
- **Улучшения подсказок**:
  - Патроны и черты оружия теперь корректно используют `Mutually Exclusive Groups`, предотвращая дублирование или конфликтующие черты.
  - Отсутствующие черты оружия отображаются тёмным цветом для ясности.
- **Предметы, произведённые на Magnum**:
  - Теперь помечаются буквой `"M"` для отличия от других предметов с редкостью.
  - Сравнение в подсказках теперь приоритизирует модифицированный аналог, если он существует; иначе сравнение идёт с базовым стандартным предметом.
  - *Примечание:* Это касается только вновь созданных предметов — уже существующие не изменяются.
- **Размер шрифта в подсказках**: Теперь автоматически уменьшается, если текст не помещается — улучшена читаемость.

### Исправлено
- **Характеристики существ**: Исправлена логика, которая по ошибке применяла *ослабленные* характеристики по умолчанию вместо *усиленных*.
- **Подсказки для AP (очков действий) и LoS (обзора)**: Исправлены отображаемые значения.
- **Сопоставление слотов аугментаций**: Если в сохранении отсутствует значение слота аугментации, система теперь определяет корректное значение на основе самой аугментации и добавляет его.
- **Обработка Синтраформеров**:
  - Разрешено использование во время миссий.
- **Настройка рецептов**: Откорректированы рецепты Синтраформеров и их доступность.
- **Система очистки**: Исправлено случайное удаление слотов ран и записей аугментаций.
- **Сериализация JSON**: Устранены проблемы с многоуровневым JSON в одну строку, уменьшен объём файлов и улучшена читаемость.

### Рефакторинг и внутренние изменения
- **Переупорядочение структуры папок проекта**: Улучшена удобность сопровождения и командная разработка.
- **Очистка DLL**: Удалены неиспользуемые и лишние библиотеки.
- **SynthraformerController**: Крупный рефакторинг для повышения стабильности и расширяемости.

### Исправлено (патчи)
- **Патроны и метаданные**: Теперь полностью поддерживаются в конвейере обработки Синтраформеров.
- **Шансы выброса**: Настроены и сбалансированы для соответствия ожидаемому распределению лута.

## 1.9 (5e1999f)
### Добавлено
- **Система Синтраформеров**
  - Введены новые предметы Синтраформеры с уникальными эффектами:
    - *Усилитель*: Увеличивает случайную характеристику предмета в зависимости от редкости; может затронуть ослабленные параметры, поддерживает улучшение при крафте.
    - *Рекомбинатор черт*: Полностью пересобирает черты предмета, сохраняя только те, что есть у его стандартного аналога.
    - *Случайная редкость*: Случайным образом определяет новую редкость для обычных предметов.
    - *Активатор неразрушимости*: Даёт шанс добавить черту "Неразрушимый" к предмету.
    - *Катализатор аугментаций*: Добавляет случайный положительный или отрицательный параметр к аугментации; расходуется независимо от наличия черт.
  - Добавлены соответствующие рецепты в категории *Синтраформеры* в системе крафта Magnum.

- **Подсказки**
  - Полная поддержка подсказок для Синтраформеров, включая локализацию.
  - Отсутствующие черты оружия теперь отображаются тёмным цветом для наглядности.

### Исправлено
- Исправлены случаи, когда усиленные характеристики применялись некорректно.
- Предотвращено получение нестандартных редкостей станционными предметами или их пометка как "пользовательского оружия".
- Исправлен дублирующийся суффикс у кастомного оружия в проектах Magnum — логика переименования перемещена.
- Исправлена отключённая обработка аугментаций/имплантов — частично восстановлена работа аугментов. Ведётся тестирование, присылайте файлы сохранений и логи.
- Исправлена система очистки, которая случайно удаляла слоты ран и записи аугментаций.
- Безопасная обработка отсутствующих записей в данных существ (слоты ран) при загрузке.
- Исправлена вложенная JSON-в-JSON сериализация в одну строку — уменьшен размер файлов и улучшена читаемость.
- Избегание изменения редкости при удалении аугментации, если итоговая редкость остаётся "стандартной".

### Изменено
- Обновлены префиксы в логах для лучшей читаемости при отладке.
- Отменено изменение, пропускавшее обработку редкости для стандартных предметов — теперь поведение последовательно.

### Исправлено (патчи)
- Записи патронов и метаданных теперь корректно поддерживаются в конвейере обработки Синтраформеров.

## 1.8.3 (145e1b3)
- Улучшена локализация слотов ран и поиск дескрипторов (ранее это вызывало ошибки загрузки сохранений при применении редких аугментаций)
- Логика обработки предметов переработана: по умолчанию всё запрещено, разрешается только после явной проверки и валидации

## 1.8.2 (40f9eb0)
- Исправлено: выход из миссии через Esc (сохранение и выход) не сохранял метаданные предметов, из-за чего те возвращались к стандартным значениям

## 1.8.1 (6202d68)
- Исправлено: некоторые предметы сбрасывались до значений по умолчанию при переключении между сохранениями без перезапуска игры

## 1.8 (81864aa)
- Поддержка аугментаций и имплантов
- Исправлено: ограничения улучшений проектов Magnum не работали для стандартных предметов
- Добавлена поддержка бонусов для активных имплантов
- Добавлены подсказки для аугментаций и имплантов
- Исправлены проблемы с локализацией
- Добавлены переводы названий цветов
- Добавлены настройки цветов в конфигурацию мода
- Файл `rarity.csv` расширен — теперь доступно больше редактируемых данных
- Различные косметические исправления подсказок

## 1.6-pre (7935d11)
- Рефактор системы создания предметов, теперь "внутренние" магнум проекты не нужны
- Добавлен `MobModifier` вещи так-же получают буст статов в зависимости от редкости мобов
- Поддержка **аугметаций**, **имплатов**
- Исправлен тултип, если предмет нельзя сломать - об этом сказано

### Исправления
- Исправлено отображение свойства "неразрушимый" в подсказках

## 1.5 (f9540b0)
- Улучшено ведение журнала с учётом журналов, специфичных для классов.
- Улучшена подсказка для сравнения предметов с дополнительной информацией.
- Генерация мобов теперь учитывает редкость и мастерство, включая дополнительное повышение характеристик предметов в зависимости от мастерства монстра.
- Исправлена проблема, из-за которой файлы использовались другими приложениями.
- Добавлен `MonsterInspectWindow` с поддержкой перков, подсказок и уровня мастера мобов.
- Добавлен новый спрайт класса для окна инспектора мобов.
- Исправлены проблемы десериализации и обеспечено правильное применение характеристик мобов.
- Исправлено некорректное отображение дополнительной информации в подсказке для обычных мобов.
- Исправлено повторное использование идентификаторов при генерации мобов.
- Добавлена поддержка рангов и талантов мобов.
- Добавлена поддержка перевода для нового контента.
- Добавлена возможность переключения генерации мобов.
- Обновлены вспомогательные функции и логгер для повышения производительности.
- Обновлены ресурсы Unity.

## 1.43 (80a01dc)
- Исправлено: Вопрос баланса. Созданные предметы которые являются проектом (желтая М) не будут получать характеристики редкости.

## 1.42 (1d5fcea)
- Исправлено: Некоторые предметы становились обычными. Да, надо было кое-где проверить.
- Исправлено: В некоторых случаях предметы появлялись в списке проектов, как будто они были разблокированы.
- Добавлено: Занижение параметров, теперь есть вероятность, что параметр будет уменьшен, а не увеличен, как обычно.
- Исправлено: Незначительные проблемы с форматированием подсказок.

## 1.41 (d7997d6)
- Исправлено: Для некоторых игроков характеристики модифицированных предметов были слишком экстремальными из-за региональных настроек и применялись неправильно, что приводило не только к визуальной ошибке, но и к слишком сильных характеристик предметов.
- Исправлено: Некоторые статы предметов сбрасывались.
- Префиксы предметов были обновлены, так что теперь префикс брони/оружия может определять его тип.
Например, «Перезаряженный» для оружия с электрическим уроном, «Крио» для холода, «Токсичный» для оружия с ядом, а также «Прочный» для брони. И т. д.
Спасибо сообществу за отзывы.

## 1.4 (aef44c6)
- Исправлены внутренние расчеты RNG.
- Трейты для оружия дальнего боя и ближнего боя теперь имеют исключения для удаления уж совсем абсурдных трейтов.
- Тултипы для сопротивлений брони.
- Среднее сопротивление, если применяется, не такое уж сильное.
- Исправлена ошибка, что делало броню слишком тяжелой.

## 1.3 (850ae94)
- Шанс неломаемой вещи теперь имеет взвешенное значение.
- Параметры для изменения теперь выбираются в процентном диапазоне, а не фиксированным процентом.
- Исправлена одна проблема, из-за которой некоторые предметы не обрабатывались и сбрасывались до ванильных. Наблюдаем.
- Подсказки для оружия для сравнения версии PoQ с ванильной. Горячая клавиша "левый шифт".
- CSV-файл для рарок и шансов теперь доступен для редактирования и заменяет внутренние данные. Смотрите настройки мода, чтобы включить. [Документация на GitHub](https://github.com/ARZUMATA/QM-ARZUMATA-PathOfQuasimorph/tree/main/docs)

## 1.2 (92e9f12)
- Модификаторы теперь применяются лучше.
- Одна характеристика усиливается немного сильнее, что определяет суффикс вещи.
- Улучшены усиления резистов, чтобы использовать минимальные и максимальные значения для лучшей вариативности.
- Теперь броня использует среднее значение сопротивления, чтобы определить, какое сопротивление случайным образом добавляется при успешном ролле.
- Исправлена некорректная логика усиления.
- Улучшено ведение журнала отладки для упрощения отладки и отслеживания изменений.

## 1.1 (8d85683)
- Исправлен баг, когда при начале новой игры, игра не работала.
- Некоторые файлы не загружались в воркшоп, из-за чего мод не работал.
- Обновлен манифест, чтобы он соответствовал бета версии, и не появлялся в списке модов для стабильной версии.

## 1.0 (be3c4c6)
- Первый выпуск
